
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Introduction to functions and integration &#8212; Engineering Dynamics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'getting-started/03_integrate';</script>
    <link rel="icon" href="../_static/spiderman-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples in Kasdin+Paley dynamics" href="../module_03/kasdin.html" />
    <link rel="prev" title="Solutions with equations of motion" href="../module_03/solving-eoms.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/dyn_logo.png" class="logo__image only-light" alt="Engineering Dynamics - Home"/>
    <script>document.write(`<img src="../_static/dyn_logo.png" class="logo__image only-dark" alt="Engineering Dynamics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to Applied Mechanics II - Engineering Dynamics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus - ME2120 Spring 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_00/meet_cooper.html">About the Instructor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content.html">Module Content</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_00/overview.html">Module 0 - Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_00/introduction.html">Overview</a></li>


<li class="toctree-l2"><a class="reference internal" href="01_interactions.html">HW_00 - Interacting with Python and Physics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_01/overview.html">Module 1 - Definitions and equations</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_01/readings.html">Reference Material: Videos + Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/introduction.html">Introduction to Engineering Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/philosophy.html">Philosophy of Newtonian Mechanics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/definitions.html">Definitions in Dynamics: kinematics and kinetics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/snowflake.html">Snowflake time of flight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/homework.html">Homework #1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/project.html">Project_01 - Develop Dynamics Project Proposal</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_02/overview.html">Module 2 - constrained dynamic motion</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_02/readings.html">Reference Material: Videos + Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_Working_with_Python.html">Working with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/rigid-bodies.html">Rigid body lectures and notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/mechanical-advantage.html">Mechanical advantage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/driving-forces.html">Driving forces for moving systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/valentine.html">Happy Valentine’s Linkage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/homework.html">Module_02 Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/project.html">Module 2 - Project: four-bar linkage design</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../module_03/overview.html">Module 3 - Constrained engineering systems</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../module_03/readings.html">Reference Material: Videos + Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/solving-eoms.html">Solutions with equations of motion</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Introduction to functions and integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/kasdin.html">Examples in Kasdin+Paley dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/plotting-solutions.html">Solving equations of motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/pendulum.html">Pendulum plotting solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/nonlinear.html">Nonlinear pendulum solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/hemisphere-rolling.html">Rolling on hemisphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/homework.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/project.html">Module 3 - Project: pendulum solutions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_04/overview.html">Module 4 - Momentum and Energy</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_04/readings.html">Materials</a></li>

<li class="toctree-l2"><a class="reference internal" href="../module_04/dice.html">Weighted dice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_04/central-force.html">Central force motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_04/table-momentum.html">A moving reference frame with conservation of angular momentum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_04/yoyo-despin_02.html">Yoyo despin design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_04/homework.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_04/project.html">Module_04 - project</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_05/overview.html">Module 5 - dynamics in your career</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_05/project.html">Module 05 - project <em>build an example</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="../M05_submissions/Alnaimi-rough.html">Project proposal - car accident impulse/momentum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../M05_submissions/project-6.html">Module 05 - project <em>build an example</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="../M05_submissions/ce2120%20project%20cook.html">CE 2120 Project - <em>Knee Joint Model</em></a></li>

<li class="toctree-l2"><a class="reference internal" href="../M05_submissions/Contaxis-rough.html">Project proposal - robotic arm</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cooperrc/engineering-dynamics/master?urlpath=tree/getting-started/03_integrate.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://nanohub.org/tools/dynamics/hub/user-redirect/git-pull?repo=https%3A//github.com/cooperrc/engineering-dynamics&urlpath=tree/engineering-dynamics/getting-started/03_integrate.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cooperrc/engineering-dynamics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cooperrc/engineering-dynamics/issues/new?title=Issue%20on%20page%20%2Fgetting-started/03_integrate.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/getting-started/03_integrate.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to functions and integration</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-our-own-functions">Building our own functions.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#euler-approximation">Euler approximation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runge-kutta">Runge-Kutta</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#freefall-model-computational-solution">Freefall Model Computational solution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-constants-and-analytical-solution-meters-kilogram-sec">Define constants and analytical solution (meters-kilogram-sec)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-vs-computational-solution">Analytical vs Computational Solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-numerical-method">Define numerical method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-approximation">Finite difference approximation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-solutions-plotting">Compare solutions (plotting)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-youve-learned">What you’ve learned</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-functions-and-integration">
<h1>Introduction to functions and integration<a class="headerlink" href="#introduction-to-functions-and-integration" title="Link to this heading">#</a></h1>
<p><strong>Content modified under Creative Commons Attribution license CC-BY 4.0,
code under BSD 3-Clause License © 2020 R.C. Cooper</strong></p>
<section id="building-our-own-functions">
<h2>Building our own functions.<a class="headerlink" href="#building-our-own-functions" title="Link to this heading">#</a></h2>
<p>Functions are saved in memory you can define them with anonymous functions <code class="docutils literal notranslate"><span class="pre">lambda</span></code> and function definitions <code class="docutils literal notranslate"><span class="pre">def</span></code></p>
<p>Example of storing a function in memory</p>
<p><span class="math notranslate nohighlight">\(f(x,y) = (xy^{3}-x^{3}y)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.099
</pre></div>
</div>
</div>
</div>
<p>The function, <code class="docutils literal notranslate"><span class="pre">f(x,</span> <span class="pre">y)</span></code>=<span class="math notranslate nohighlight">\(f(x,~y)\)</span>, returns <span class="math notranslate nohighlight">\(xy^3-x^3y\)</span>. Below, you create a contour plot using</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">linspace</span></code> to define the x-y-axes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meshgrid</span></code> to fill in each x-y value along each axis, (-1, -1), (-1, -0.99), …(0.99, 1), (1, 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">contourf</span></code> to display the result</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">);</span> <span class="c1"># 10 data points from -1 to 1</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">);</span> <span class="c1"># 10 data points from -1 to 1</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span> <span class="c1"># 100 data points from -1 to 1 on the x- and y-axes</span>
<span class="n">Z</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">);</span><span class="c1"># Z=f(X,Y) evaluated at the 100 data points</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="c1"># also pcolor, countour, ...</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet at 0x79138c00ecb0&gt;
</pre></div>
</div>
<img alt="../_images/ba373cc0962a0c843638b29952c90f340e666bbd0b6c3274c871a1090ed072ab.png" src="../_images/ba373cc0962a0c843638b29952c90f340e666bbd0b6c3274c871a1090ed072ab.png" />
</div>
</div>
<p><strong>For more plotting examples and options check out the <a class="reference external" href="https://matplotlib.org/gallery/index.html">Matplotlib gallery</a></strong></p>
<p>Here, define a function called <code class="docutils literal notranslate"><span class="pre">my_ode</span></code> for a single-DOF forced spring-mass-damper:</p>
<p><span class="math notranslate nohighlight">\(\ddot{x}+2\dot{x}+9x=0.01\cos(2t)\)</span></p>
<p>Its initial postion and velocity are</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x(0) = 0.1~m\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(v(0) = 0~m/s\)</span></p></li>
</ul>
<p>In order to use a computational method to integrate this differential equation, you have to define a set of first order differential equations. You set these up as such</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\frac{dx}{dt} = v(t)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{dv}{dt} = a(t) = -2\dot{x}-9x+0.01\cos(2t)\)</span></p></li>
</ol>
<p>Now, you have 2 <em>first-order</em> equations that relate <span class="math notranslate nohighlight">\(v~and~a\)</span> to <span class="math notranslate nohighlight">\(x~and~v\)</span>. You can create a variable called <span class="math notranslate nohighlight">\(\mathbf{r}=[x,~v]\)</span> so that</p>
<p><span class="math notranslate nohighlight">\(\frac{d\mathbf{r}}{dt} = f(t, \mathbf{r})\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_ode</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Help documentation for &quot;my_ode&quot;</span>
<span class="sd">     input is time, t (s) and r=[position (m); velocity (m/s)] and time</span>
<span class="sd">     output is dr=[velocity (m/s); acceleration (m/s/s)] at time, t</span>
<span class="sd">     the ODE is defined by:</span>
<span class="sd">    </span>
<span class="sd">     a = -2*v-9*x+ 0.01*cos(2t)&quot;&quot;&quot;</span>
    
    <span class="n">dr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">dr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">9</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">dr</span>
</pre></div>
</div>
</div>
</div>
<p>Given any <code class="docutils literal notranslate"><span class="pre">[position,</span> <span class="pre">velocity]</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>, the defined <code class="docutils literal notranslate"><span class="pre">my_ode</span></code> returns the velocity and acceleration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_ode</span><span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  2.  , -12.99])
</pre></div>
</div>
</div>
</div>
</section>
<section id="euler-approximation">
<h2>Euler approximation<a class="headerlink" href="#euler-approximation" title="Link to this heading">#</a></h2>
<p>The simplest integration routine is the Euler approximation. A first-order Taylor series expansion about the current timestep:</p>
<p><span class="math notranslate nohighlight">\(r_{i+1}=r_{i}+\frac{dr_{i}}{dt}\Delta t\)</span></p>
<p>You can integrate the equation in a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">for</span></code>-loop: Is defined in Python by using the function, <code class="docutils literal notranslate"><span class="pre">for</span></code>. You specify the variable, <code class="docutils literal notranslate"><span class="pre">i</span></code>, and the values, <code class="docutils literal notranslate"><span class="pre">range(1,</span> <span class="pre">len(t))</span></code> i = (1, 2, … 100).</p>
</div></blockquote>
<p>Each step in the loop approximates the next position based upon the current velocity and the next velocity based upon the current acceleration.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x(t+\Delta t) = x(t) + v(t)*\Delta t\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(v(t+\Delta t) = v(t) + a(t)*\Delta t\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="c1"># (start, stop, total steps)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># time step</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">v0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="n">my_ode</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,:])</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">dr</span><span class="o">*</span><span class="n">dt</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;position (m)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;position (m)&#39;)
</pre></div>
</div>
<img alt="../_images/3ffdbce035c1905a465c15082ce0d2343f0e461a016c628e2371349cd606ddfb.png" src="../_images/3ffdbce035c1905a465c15082ce0d2343f0e461a016c628e2371349cd606ddfb.png" />
</div>
</div>
</section>
<section id="runge-kutta">
<h2>Runge-Kutta<a class="headerlink" href="#runge-kutta" title="Link to this heading">#</a></h2>
<p>Using <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code> in Python you can use more advanced integration routines, such as <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#r179348322575-1">Runge-Kutta 5(4)</a>, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#r179348322575-3">Runge-Kutta 3(2)</a>, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#r179348322575-7">Adams/BDF method</a>, etc.</p>
<p>Numerical integration algorithms for differential equations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span> <span class="c1"># import the ordinary differential equation integrator in Python</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r23</span><span class="o">=</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">my_ode</span><span class="p">,[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],[</span><span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">],</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK23&#39;</span><span class="p">);</span>
<span class="n">r45</span><span class="o">=</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">my_ode</span><span class="p">,[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],[</span><span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">],</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">);</span> <span class="c1"># default = &#39;RK45&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r23</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">r23</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r45</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">r45</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;RK23&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Euler&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="c1">#axis([0 10 -0.2 0.3])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;position (m)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;position (m)&#39;)
</pre></div>
</div>
<img alt="../_images/b90a91711a27eadeefc2b031ec939ce8ccd7d5822de571a7d9dfd78d84b36b3d.png" src="../_images/b90a91711a27eadeefc2b031ec939ce8ccd7d5822de571a7d9dfd78d84b36b3d.png" />
</div>
</div>
</section>
<section id="freefall-model-computational-solution">
<h2>Freefall Model Computational solution<a class="headerlink" href="#freefall-model-computational-solution" title="Link to this heading">#</a></h2>
<img alt="../_images/freefall.png" src="../_images/freefall.png" />
<p>Here is our first computational mechanics model.</p>
<p>An object falling is subject to the force of</p>
<ul class="simple">
<li><p>gravity (<span class="math notranslate nohighlight">\(F_g\)</span>=mg) and</p></li>
<li><p>drag (<span class="math notranslate nohighlight">\(F_d=cv^2\)</span>)</p></li>
</ul>
<p>Acceleration of the object:</p>
<p><span class="math notranslate nohighlight">\(\sum F=ma=F_g-F_d=mg - cv^2 = m\frac{dv}{dt}\)</span></p>
<section id="define-constants-and-analytical-solution-meters-kilogram-sec">
<h3>Define constants and analytical solution (meters-kilogram-sec)<a class="headerlink" href="#define-constants-and-analytical-solution-meters-kilogram-sec" title="Link to this heading">#</a></h3>
<p>We define parameters for our problem as the acceleration due to gravity, g, drag coefficient, c, and mass of the object, m. Once we have defined these parameters, we have a single variable whose derivative <span class="math notranslate nohighlight">\(\frac{dv}{dt}\)</span> is equal to a function of itself <span class="math notranslate nohighlight">\(v\)</span> i.e. <span class="math notranslate nohighlight">\(\frac{dv}{dt} = f(v,~parameters)\)</span>.</p>
<p><strong>parameters:</strong></p>
<p>g=9.81 m/s<span class="math notranslate nohighlight">\(^2\)</span>, c=0.25 kg/m, m=60 kg</p>
<p><strong>function:</strong></p>
<p><span class="math notranslate nohighlight">\(\frac{dv}{dt} = g-\frac{c}{m}v^2\)</span></p>
<p>We can solve for the analytical solution in this case. First, consider the speed of the falling object when acceleration is <span class="math notranslate nohighlight">\(\frac{dv}{dt}=0\)</span>, this is called the terminal velocity, <span class="math notranslate nohighlight">\(v_{terminal}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(v_{terminal}=\sqrt{\frac{mg}{c}}\)</span></p>
<p>Now, substitute this terminal velocity into the equation and integrate to get the analytical solution v(t):</p>
<p><span class="math notranslate nohighlight">\(v(t)=v_{terminal}\tanh{\left(\frac{gt}{v_{terminal}}\right)}\)</span>.</p>
</section>
</section>
<section id="exercise">
<h2>Exercise:<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h2>
<p>Calculate the terminal velocity for the given parameters, g=9.81 m/s<span class="math notranslate nohighlight">\(^2\)</span>, c=0.25 kg/m, m=60 kg.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">=</span><span class="mf">0.25</span> 
<span class="n">m</span><span class="o">=</span><span class="mi">60</span>
<span class="n">g</span><span class="o">=</span><span class="mf">9.81</span> 


<span class="k">def</span> <span class="nf">v_analytical</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Analytical solution for the velocity of an object released from rest subject to </span>
<span class="sd">    the force of gravity and the force of drag with drag coefficient, c</span>
<span class="sd">    </span>
<span class="sd">    Arguments </span>
<span class="sd">    ---------</span>
<span class="sd">    t: time, the independent variable</span>
<span class="sd">    m: mass of the object</span>
<span class="sd">    g: acceleration due to gravity</span>
<span class="sd">    c: drag coefficient</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    v: the speed of the object at time t&#39;&#39;&#39;</span>
    
    <span class="n">v_terminal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>
    <span class="n">v</span><span class="o">=</span> <span class="n">v_terminal</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">v_terminal</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>
</pre></div>
</div>
</div>
</div>
<p>Inside the curly brackets—the placeholders for the values we want to print—the <code class="docutils literal notranslate"><span class="pre">f</span></code> is for <code class="docutils literal notranslate"><span class="pre">float</span></code> and the <code class="docutils literal notranslate"><span class="pre">.4</span></code> is for four digits after the decimal dot. The colon here marks the beginning of the format specification (as there are options that can be passed before). There are so many tricks to Python’s string formatter that you’ll usually look up just what you need.
Another useful resource for string formatting is the <a class="reference external" href="https://mkaz.blog/code/python-string-format-cookbook/">Python String Format Cookbook</a>. Check it out!</p>
<p>Printing these values using the string formatter,  with a total length of <code class="docutils literal notranslate"><span class="pre">5</span></code> and only printing 2 decimal digits, we can display our solution in a human-readable way.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{:</span><span class="mf">5.2</span><span class="n">f</span><span class="p">}</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">:5</span></code> prints something with whitespace that is 5 spaces total</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.2</span></code> prints 2 significant figures after the decimal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> tells <code class="docutils literal notranslate"><span class="pre">format</span></code> that the input is a floating point number to print</p></li>
</ul>
</section>
<section id="analytical-vs-computational-solution">
<h2>Analytical vs Computational Solution<a class="headerlink" href="#analytical-vs-computational-solution" title="Link to this heading">#</a></h2>
<p>The analytical solution above gives us an exact function for <span class="math notranslate nohighlight">\(v(t)\)</span>. We can input any time, <code class="docutils literal notranslate"><span class="pre">t</span></code>, and calculate the speed, <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
<p>In many engineering problems, we cannot find or may not need an exact mathematical formula for our design process. It is always helpful to compare a computational solution to an analytical solution, because it will tell us if our computational solution is correct. Next, we will develop the <strong>Euler approximation</strong> to solve the same problem.</p>
</section>
<section id="define-numerical-method">
<h2>Define numerical method<a class="headerlink" href="#define-numerical-method" title="Link to this heading">#</a></h2>
<section id="finite-difference-approximation">
<h3>Finite difference approximation<a class="headerlink" href="#finite-difference-approximation" title="Link to this heading">#</a></h3>
<p>Computational models do not solve for functions e.g. v(t), but rather functions at given points in time (or space). In the given freefall example, we can approximate the derivative of speed, the speed at the next poitn in time given the current time and its current speed as such</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">=</span><span class="mf">0.25</span> 
<span class="n">m</span><span class="o">=</span><span class="mi">60</span>
<span class="n">g</span><span class="o">=</span><span class="mf">9.81</span> 


<span class="k">def</span> <span class="nf">freefall_acceleration</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Analytical solution for the velocity of an object released from rest subject to </span>
<span class="sd">    the force of gravity and the force of drag with drag coefficient, c</span>
<span class="sd">    </span>
<span class="sd">    Arguments </span>
<span class="sd">    ---------</span>
<span class="sd">    t: time, the independent variable</span>
<span class="sd">    m: mass of the object</span>
<span class="sd">    g: acceleration due to gravity</span>
<span class="sd">    c: drag coefficient</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a: the acceleratio of the object at time t given speed v&#39;&#39;&#39;</span>
    
    <span class="n">a</span> <span class="o">=</span> <span class="n">g</span> <span class="o">-</span> <span class="n">c</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">a</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-solutions-plotting">
<h3>Compare solutions (plotting)<a class="headerlink" href="#compare-solutions-plotting" title="Link to this heading">#</a></h3>
<p>We can compare solutions in a figure in a number of ways:</p>
<ol class="arabic simple">
<li><p>plot the values, e.g. <span class="math notranslate nohighlight">\(v_{analytical}\)</span> and <span class="math notranslate nohighlight">\(v_{numerical}\)</span></p></li>
<li><p>plot the difference between the values (the absolute error) e.g. <span class="math notranslate nohighlight">\(v_{numerical}-v_{analytical}\)</span></p></li>
<li><p>plot the ratio of the values e.g. <span class="math notranslate nohighlight">\(\frac{v_{numerical}}{v_{analytical}}\)</span> (useful in finding bugs, unit analysis, etc.)</p></li>
<li><p>plot the ratio of the error to the best estimate (the relative error) e.g. <span class="math notranslate nohighlight">\(\frac{v_{numerical}-v_{analytical}}{v_{analytical}}\)</span></p></li>
</ol>
<p>Let’s start with method (1) to compare our analytical and computational solutions.</p>
<p>Import <code class="docutils literal notranslate"><span class="pre">pyplot</span></code> and update the default plotting parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">v_numerical</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">freefall_acceleration</span><span class="p">,</span> 
                        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="c1"># start time = 0s end time = 6 s</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="c1"># initial speed is 0 m/s</span>
                        <span class="n">t_eval</span> <span class="o">=</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># evaluate at timesteps in t</span>
<span class="n">v_numerical</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  message: The solver successfully reached the end of the integration interval.
  success: True
   status: 0
        t: [ 0.000e+00  1.000e+00  2.000e+00  3.000e+00  4.000e+00
             5.000e+00  6.000e+00]
        y: [[ 0.000e+00  9.678e+00  1.861e+01  2.628e+01  3.247e+01
              3.718e+01  4.064e+01]]
      sol: None
 t_events: None
 y_events: None
     nfev: 44
     njev: 0
      nlu: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">v_analytical</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_numerical</span><span class="o">.</span><span class="n">t</span> <span class="p">,</span><span class="n">v_numerical</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;velocity (m/s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;velocity (m/s)&#39;)
</pre></div>
</div>
<img alt="../_images/f8234abe6aca470647f00f177519efc75939f1fcced4b4d21847837b90cc4057.png" src="../_images/f8234abe6aca470647f00f177519efc75939f1fcced4b4d21847837b90cc4057.png" />
</div>
</div>
<p><strong>Note:</strong> In the above plot, the numerical solution is given at discrete points connected by lines, while the analytical solution is drawn as a line. This is a helpful convention. We plot discrete data such as numerical solutions or measured data as points and lines while analytical solutions are drawn as lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_numerical</span><span class="o">.</span><span class="n">t</span> <span class="p">,</span>
         <span class="n">v_numerical</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v_analytical</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
         <span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;velocity (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;error in numerical result&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;error in numerical result&#39;)
</pre></div>
</div>
<img alt="../_images/120c123b5e83eb6a80f2f61e82ccb531fc9c9524dff8ff2718c5c09a3dc17747.png" src="../_images/120c123b5e83eb6a80f2f61e82ccb531fc9c9524dff8ff2718c5c09a3dc17747.png" />
</div>
</div>
<p><strong>Note</strong>: In the above plot, the error is calculated as a difference between numerical and analytical result. Try changing the y axis to a relative error using the formula</p>
<p><span class="math notranslate nohighlight">\(relative~error = \frac{|v_{numerical} - v_{analytical}|}{|v_analytical|}\)</span></p>
</section>
</section>
<section id="what-youve-learned">
<h2>What you’ve learned<a class="headerlink" href="#what-youve-learned" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Numerical integration with the Euler approximation and <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code></p></li>
<li><p>How to time a numerical solution or a function</p></li>
<li><p>How to compare solutions</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./getting-started"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../module_03/solving-eoms.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Solutions with equations of motion</p>
      </div>
    </a>
    <a class="right-next"
       href="../module_03/kasdin.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Examples in Kasdin+Paley dynamics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-our-own-functions">Building our own functions.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#euler-approximation">Euler approximation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runge-kutta">Runge-Kutta</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#freefall-model-computational-solution">Freefall Model Computational solution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-constants-and-analytical-solution-meters-kilogram-sec">Define constants and analytical solution (meters-kilogram-sec)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-vs-computational-solution">Analytical vs Computational Solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-numerical-method">Define numerical method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finite-difference-approximation">Finite difference approximation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-solutions-plotting">Compare solutions (plotting)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-youve-learned">What you’ve learned</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href = https://cooperrc.github.io> Ryan C. Cooper</a>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>